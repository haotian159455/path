package com.fh.shop.controller.product;import com.fh.shop.aspect.LogMessage;import com.fh.shop.biz.product.IShopService;import com.fh.shop.commen.Datetables;import com.fh.shop.commen.ServerResponse;import com.fh.shop.param.product.ParamSearchShop;import com.fh.shop.po.brand.Brand;import com.fh.shop.po.product.Shop;import com.fh.shop.utils.ExcelUtil;import com.fh.shop.utils.FileInputUtil;import com.fh.shop.vo.product.ShopVo;import org.apache.poi.hssf.usermodel.HSSFDataFormat;import org.apache.poi.xssf.usermodel.*;import org.slf4j.LoggerFactory;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.bind.annotation.ResponseBody;import org.springframework.web.multipart.commons.CommonsMultipartFile;import javax.annotation.Resource;import javax.servlet.http.HttpServletResponse;import java.util.List;import java.util.Map;import org.apache.poi.ss.usermodel.Workbook;import com.fh.shop.utils.FileUtil;@Controller@RequestMapping("pro")public class ShopController {    @Resource(name="shopService")    private IShopService shopService;    @RequestMapping("/toList")    public String toList(){        return "/product/list";    }    @RequestMapping("findPageShopList")    @ResponseBody    public Datetables findPageShopList(ParamSearchShop paramSearchShop){       Long count= shopService.findShopCount(paramSearchShop);       List<ShopVo> shopVoList =shopService.findPageShopList(paramSearchShop);       Datetables ShopList = new Datetables(paramSearchShop.getDraw(),count,count,shopVoList);       return ShopList;    }    private  static final org.slf4j.Logger LOGGER=LoggerFactory.getLogger(ShopController.class);    @RequestMapping("/addShop")    @LogMessage("商品新增方法")    @ResponseBody    public ServerResponse addShop(Shop shop){            shopService.addShop(shop);            return  ServerResponse.success();    }    @RequestMapping("/deleteShop")    @LogMessage("商品删除方法")    @ResponseBody    public ServerResponse deleteShop(int id){            shopService.deleteShop(id);            return  ServerResponse.success();    }    @RequestMapping("findUpdateShop")    @LogMessage("商品回显方法")    @ResponseBody    public ServerResponse findUpdateShop(int id){            ShopVo shop= shopService.findUpdateShop(id);            return  ServerResponse.success(shop);    }    @RequestMapping("isUpShop")    @ResponseBody    public ServerResponse isUpShop(int id){           shopService.isUpShop(id);            return  ServerResponse.success();    }    @RequestMapping("/updateShop")    @LogMessage("商品修改方法")    @ResponseBody    public ServerResponse updateShop(Shop shop){            shopService.updateShop(shop);            return  ServerResponse.success();    }    //fileInput上传图片    @RequestMapping("/addFileInputShop")    public Map addFileInputShop(@RequestParam("files") CommonsMultipartFile file){        Map result=FileInputUtil.fileInput(file);        return result;    }    @RequestMapping("/exportExcel")    public void exportExcel(ParamSearchShop productSearchParam, HttpServletResponse response) {        // 查询符合条件的数据        List<Shop> shopList = shopService.findShopList(productSearchParam);        String [] title = {"商品名称","商品价格","商品类型","上架时间"};        String [] body = {"shopName","price","clName","shopTime"};        XSSFWorkbook workbook = ExcelUtil.XSSF(shopList, "商品列表", title, body, Shop.class);        // 下载        FileUtil.excelDownload(workbook,response);    }}